
CREATE TABLE Disciplina (
	ID INT IDENTITY,
	NOME VARCHAR(100) NOT NULL,
	DATA DATETIME NOT NULL DEFAULT (GETDATE()),
	STATUS VARCHAR(7) NOT NULL DEFAULT ('Aberta'),
	PLANODEENSINO VARCHAR(50) NOT NULL,
	CARGAHORARIA TINYINT NOT NULL,
	COMPETENCIAS VARCHAR(100) NOT NULL,
	HABILIDADES VARCHAR(100) NOT NULL,
	EMENTA VARCHAR(100) NOT NULL,
	CONTEUDOPROGRAMATICO VARCHAR(1000) NOT NULL,
	BIBLIOGRAFICABASICA VARCHAR(1000) NOT NULL,
	BIBLIOGRAFIACOMPLEMENTAR VARCHAR(1000) NOT NULL,
	PERCENTUALPRATICO TINYINT NOT NULL,
	PERCENTUALTEORICO TINYINT NOT NULL,
	IDCOORDENADOR INT NOT NULL,
	
	CONSTRAINT PK_DISCIPLINA PRIMARY KEY(ID),
	--CONSTRAINT FK_DISCIPLINA_COORDENADOR FOREIGN KEY (IDCOORDENADOR)
	--REFERENCES Coordenador (ID),
	CONSTRAINT CK_DISCIPLINA_CARGAHORARIA CHECK (CARGAHORARIA IN (40, 80)),
	CONSTRAINT CK_DISCIPLINA_PERCENTUALPRATICO CHECK (PERCENTUALPRATICO BETWEEN 0 AND 100),
	CONSTRAINT CK_DISCIPLINA_PERCENTUALTEORICO CHECK (PERCENTUALTEORICO BETWEEN 0 AND 100),
	CONSTRAINT CK_DISCIPLINA_STATUS CHECK (STATUS IN ('Aberta', 'Fechada')),
	--CONSTRAINT DF_DISCIPLINA_STATUS DEFAULT ('Aberta') FOR STATUS,
	--CONSTRAINT DF_DISCIPLINA_DATA DEFAULT (GETDATE()) FOR DATA,
	CONSTRAINT UQ_DISCIPLINA_NOME UNIQUE (NOME)

);

CREATE TABLE DisciplinaOfertada (
	ID INT IDENTITY,
	IDCOORDENADOR INT NOT NULL,
	DTINICIOMATRICULA DATE,
	DTFIMMATRICULA DATE,
	IDDISCIPLINA INT NOT NULL,
	IDCURSO INT NOT NULL,
	ANO SMALLINT NOT NULL,
	SEMESTRE TINYINT NOT NULL,
	TURMA CHAR(1) NOT NULL,
	IDPROFESSOR INT,
	METODOLOGIA VARCHAR(1000),
	RECURSOS VARCHAR(1000),
	CRITERIOAVALIACAO VARCHAR(1000),
	PLANODEAULAS VARCHAR(1000),
	
	CONSTRAINT PK_DISCIPLINAOFERTADA PRIMARY KEY(ID),
	--CONSTRAINT FK_DISCIPLINAOFERTADA_COORDENADOR FOREIGN KEY (IDCOORDENADOR)
	--REFERENCES Coordenador (ID),
	CONSTRAINT FK_DISCIPLINAOFERTADA_DISCIPLINA FOREIGN KEY (IDDISCIPLINA)
	REFERENCES Disciplina (ID),
	--CONSTRAINT FK_DISCIPLINAOFERTADA_CURSO FOREIGN KEY (IDCURSO)
	--REFERENCES Curso (ID),
	--CONSTRAINT FK_DISCIPLINAOFERTADA_PROFESSOR FOREIGN KEY (IDPROFESSOR)
	--REFERENCES Professor (ID),
	CONSTRAINT CK_DISCIPLINAOFERTADA_ANO CHECK(ANO BETWEEN 1900 AND 2100),
	CONSTRAINT CK_DISCIPLINAOFERTADA_SEMESTRE CHECK(SEMESTRE IN (1,2)),
	CONSTRAINT CK_DISCIPLINAOFERTADA_TURMA CHECK (TURMA >= 'A' AND TURMA <= 'Z'),
	CONSTRAINT UQ_DISCIPLINAOFERTADA_CURSO_ANO_SEMESTRE_TURMA UNIQUE (IDCURSO, ANO, SEMESTRE, TURMA)
);
